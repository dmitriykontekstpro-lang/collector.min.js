# üìä –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø SQL –°–•–ï–ú–ê - Tilda Analytics

**–í–µ—Ä—Å–∏—è**: 2.0.1  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-12-23  
**Supabase Project**: qqfyjrugrinmdijpsutj

---

## üéØ –ß—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

### ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- `IF NOT EXISTS` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- `ON DELETE CASCADE` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ payload (–º–∞–∫—Å 100KB)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ device_type —á–µ—Ä–µ–∑ CHECK constraint

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫
- –ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (WHERE) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
- GIN –∏–Ω–¥–µ–∫—Å –Ω–∞ JSONB –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:
- –¢—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `updated_at`
- –í–∞–ª–∏–¥–∞—Ü–∏—è payload –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
- –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views) –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞:
- –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ —Å–µ—Å—Å–∏–∏
- –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–ª–µ–π –ú–µ—Ç—Ä–∏–∫–∏
- Views –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ö–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞

---

## üìÅ –§–∞–π–ª—ã SQL

### 1. **schema_quick.sql** (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è –Ω–∞—á–∞–ª–∞)
–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞, —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã.

**–†–∞–∑–º–µ—Ä**: 70 —Å—Ç—Ä–æ–∫  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~1 —Å–µ–∫—É–Ω–¥–∞  
**–î–ª—è –∫–æ–≥–æ**: –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, MVP

### 2. **schema_full.sql** (–ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è)
–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è: —Ç—Ä–∏–≥–≥–µ—Ä—ã, —Ñ—É–Ω–∫—Ü–∏–∏, views, –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

**–†–∞–∑–º–µ—Ä**: 250+ —Å—Ç—Ä–æ–∫  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~3-5 —Å–µ–∫—É–Ω–¥  
**–î–ª—è –∫–æ–≥–æ**: Production, –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã

### 3. **1_create_tables.sql** (–°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
–ë–∞–∑–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ —É–ª—É—á—à–µ–Ω–∏–π.

**–°—Ç–∞—Ç—É—Å**: –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —É—Å—Ç–∞—Ä–µ–ª–∞  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ï—Å–ª–∏ —É–∂–µ —Å–æ–∑–¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—ã

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase

1. https://app.supabase.com
2. –ü—Ä–æ–µ–∫—Ç: `qqfyjrugrinmdijpsutj`
3. **SQL Editor** (—Å–ª–µ–≤–∞ –≤ –º–µ–Ω—é)

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

**–î–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫:**
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ schema_quick.sql
-- –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
-- –ù–∞–∂–º–∏—Ç–µ RUN
```

**–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö:**
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ schema_full.sql
-- –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
-- –ù–∞–∂–º–∏—Ç–µ RUN
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name IN ('users', 'sessions', 'events');

-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 3 —Å—Ç—Ä–æ–∫–∏: users, sessions, events
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

### USERS (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª–µ            ‚îÇ –¢–∏–ø      ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id              ‚îÇ BIGSERIAL‚îÇ PK           ‚îÇ
‚îÇ user_id         ‚îÇ UUID     ‚îÇ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID‚îÇ
‚îÇ device_fingerprint‚îÇ TEXT   ‚îÇ –û—Ç–ø–µ—á–∞—Ç–æ–∫    ‚îÇ
‚îÇ contact_data    ‚îÇ JSONB    ‚îÇ Email/Phone  ‚îÇ
‚îÇ last_seen_at    ‚îÇ TIMESTAMPTZ‚îÇ –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç‚îÇ
‚îÇ created_at      ‚îÇ TIMESTAMPTZ‚îÇ –°–æ–∑–¥–∞–Ω–æ      ‚îÇ
‚îÇ updated_at      ‚îÇ TIMESTAMPTZ‚îÇ –û–±–Ω–æ–≤–ª–µ–Ω–æ    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### SESSIONS (–°–µ—Å—Å–∏–∏)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª–µ            ‚îÇ –¢–∏–ø      ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id              ‚îÇ BIGSERIAL‚îÇ PK           ‚îÇ
‚îÇ session_id      ‚îÇ UUID     ‚îÇ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID‚îÇ
‚îÇ user_id         ‚îÇ UUID     ‚îÇ FK ‚Üí users   ‚îÇ
‚îÇ utm_source      ‚îÇ TEXT     ‚îÇ –ò—Å—Ç–æ—á–Ω–∏–∫     ‚îÇ
‚îÇ utm_campaign    ‚îÇ TEXT     ‚îÇ –ö–∞–º–ø–∞–Ω–∏—è     ‚îÇ
‚îÇ device_type     ‚îÇ TEXT     ‚îÇ desktop/mobile‚îÇ
‚îÇ browser         ‚îÇ TEXT     ‚îÇ Chrome/Safari‚îÇ
‚îÇ session_duration‚îÇ INTEGER  ‚îÇ –°–µ–∫—É–Ω–¥—ã      ‚îÇ
‚îÇ created_at      ‚îÇ TIMESTAMPTZ‚îÇ –ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### EVENTS (–°–æ–±—ã—Ç–∏—è)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª–µ            ‚îÇ –¢–∏–ø      ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id              ‚îÇ BIGSERIAL‚îÇ PK           ‚îÇ
‚îÇ session_id      ‚îÇ UUID     ‚îÇ FK ‚Üí sessions‚îÇ
‚îÇ event_type      ‚îÇ TEXT     ‚îÇ –¢–∏–ø —Å–æ–±—ã—Ç–∏—è  ‚îÇ
‚îÇ page_url        ‚îÇ TEXT     ‚îÇ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚îÇ
‚îÇ target_element  ‚îÇ TEXT     ‚îÇ CSS selector ‚îÇ
‚îÇ target_text     ‚îÇ TEXT     ‚îÇ –¢–µ–∫—Å—Ç —ç–ª–µ–º–µ–Ω—Ç–∞‚îÇ
‚îÇ payload         ‚îÇ JSONB    ‚îÇ –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏  ‚îÇ
‚îÇ created_at      ‚îÇ TIMESTAMPTZ‚îÇ –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîç –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Views (–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

#### 1. events_stats
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ —Ç–∏–ø–∞–º –∏ –¥–Ω—è–º:
```sql
SELECT * FROM events_stats
WHERE date > CURRENT_DATE - 7
ORDER BY date DESC, count DESC;
```

#### 2. active_users_7d
–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ –Ω–µ–¥–µ–ª—é:
```sql
SELECT * FROM active_users_7d
LIMIT 100;
```

#### 3. conversion_funnel
–ö–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞:
```sql
SELECT * FROM conversion_funnel
WHERE date > CURRENT_DATE - 30;
```

### –§—É–Ω–∫—Ü–∏–∏

#### get_session_metrics()
–í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Å—Å–∏–∏:
```sql
SELECT * FROM get_session_metrics('session-uuid-here');
```

#### get_yandex_goals()
–¶–µ–ª–∏ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥:
```sql
SELECT * FROM get_yandex_goals(
  '2025-01-01'::timestamptz,
  '2025-01-31'::timestamptz
);
```

---

## üéØ –ü–æ–ª–µ–∑–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã

### –°–æ–±—ã—Ç–∏—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è:
```sql
SELECT event_type, COUNT(*) 
FROM events 
WHERE created_at > CURRENT_DATE
GROUP BY event_type
ORDER BY count DESC;
```

### –¢–æ–ø 10 —Å—Ç—Ä–∞–Ω–∏—Ü:
```sql
SELECT page_url, COUNT(*) as views
FROM events
WHERE event_type = 'page_view'
GROUP BY page_url
ORDER BY views DESC
LIMIT 10;
```

### –í—Å–µ —Ü–µ–ª–∏ –ú–µ—Ç—Ä–∏–∫–∏:
```sql
SELECT 
  target_text as goal_name,
  COUNT(*) as count,
  DATE(created_at) as date
FROM events
WHERE event_type = 'yandex_goal'
GROUP BY target_text, DATE(created_at)
ORDER BY date DESC, count DESC;
```

### –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π:
```sql
SELECT 
  session_id,
  payload->'metrics'->>'total_clicks' as clicks,
  payload->'metrics'->>'max_scroll_depth_percent' as scroll_depth,
  created_at
FROM events
WHERE event_type = 'session_end'
ORDER BY created_at DESC
LIMIT 50;
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è:
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ user_id, session_id
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ event_type
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ created_at
- ‚úÖ –ü–æ–∏—Å–∫ –≤ JSONB payload
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ UTM –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

### –û–∂–∏–¥–∞–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å:
- –í—Å—Ç–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è: **<5ms**
- –ó–∞–ø—Ä–æ—Å –º–µ—Ç—Ä–∏–∫ —Å–µ—Å—Å–∏–∏: **<50ms**
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∑–∞ –¥–µ–Ω—å: **<500ms**
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∑–∞ –º–µ—Å—è—Ü: **<5s**

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ö–µ–º—ã

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã:

```sql
-- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_events_type_created 
ON events(event_type, created_at DESC);

-- –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä updated_at
-- (–∫–æ–¥ –≤ schema_full.sql)

-- –°–æ–∑–¥–∞—Ç—å views
-- (–∫–æ–¥ –≤ schema_full.sql)
```

---

## üìö –§–∞–π–ª—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

1. **schema_quick.sql** ‚Üê –ù–∞—á–Ω–∏—Ç–µ —Å —ç—Ç–æ–≥–æ!
2. **schema_full.sql** ‚Üê –î–ª—è production
3. **2_setup_rls.sql** ‚Üê RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
4. **3_verify_setup.sql** ‚Üê –ü—Ä–æ–≤–µ—Ä–∫–∞

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

- [ ] –í—ã–±—Ä–∞—Ç—å –≤–µ—Ä—Å–∏—é (quick –∏–ª–∏ full)
- [ ] –û—Ç–∫—Ä—ã—Ç—å Supabase SQL Editor
- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—Ç–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö

---

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `schema_quick.sql` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞!** üöÄ

–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –∏–∑ `schema_full.sql` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ.
